#!/usr/bin/env node

global := $global

if (global.__trapList__ == undefined) {
	global.__trapList__ = []
}
trapList := global.__trapList__


try := [tryBlock catchBlock]->{
	oldTrapFn := trap call

	cc call [break]->{
		trap call [e]->{
			catchBlock call e
			break call
		}
		tryBlock call
		break call
	}

	trap call oldTrapFn
}

raise := [e]->{
	trap call | call e
}

{
	.try try
	.raise raise
}
