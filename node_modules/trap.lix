#!/usr/bin/env node

trapList := []
global := $global

if (global.__trapList__ == undefined) {
	global.__trapList__ = []
} else {
	trapList := global.__trapList__
}

try := [tryBlock catchBlock]->{
	cc call [brk]->{
		trapList .Push [e]->{
			catchBlock call e
			brk call
		}
		tryBlock call
		trapList .Pop
		brk call
	}
}

raise := [e]->{
	trapList .Pop | call e
}

{
	.try try
	.raise raise
}
